---
date: 2024-09-06
tags:
  - Процедурне_програмування
  - Налагодження
---
Припустимо, ви написали програму, і вона працює неправильно - код компілюється добре, але коли ви запускаєте її, то отримуєте неправильний результат. Мабуть, у вас десь є семантична помилка. Як її знайти? Якщо ви слідували найкращим практикам, пишучи невеликий шматок коду, а потім тестуючи його, ви можете мати гарне уявлення про те, де саме у вас помилка. Або ж ви можете не мати жодних здогадок.

Всі помилки виникають з простої передумови: щось, що ви вважали правильним, не є таким. Насправді з'ясувати, де саме знаходиться помилка, може бути непросто. У цьому уроці ми розглянемо загальний процес налагодження програми.

Оскільки ми ще не розглянули багато тем з C++, наші приклади програм у цій главі будуть досить простими. Через це деякі прийоми, які ми тут показуємо, можуть здатися вам надмірними. Однак пам'ятайте, що ці методи призначені для використання з більшими і складнішими програмами, і саме в таких умовах вони будуть більш корисними (а саме тут вони вам найбільше знадобляться).
## Загальний підхід до налагодження
Після того, як проблему виявлено, налагодження проблеми зазвичай складається з шести кроків:

- Знайдіть першопричину проблеми (зазвичай це рядок коду, який не працює).
- Переконайтеся, що ви розумієте, чому виникає проблема.
- Визначте, як ви будете вирішувати проблему.
- Виправте помилку, що викликала проблему.
- Повторіть тестування, щоб переконатися, що проблему вирішено.
- Повторно протестуйте, щоб переконатися, що не з'явилися нові проблеми.

Давайте використаємо аналогію з реального життя. Скажімо, одного вечора ви йдете за льодом до льодогенератора в морозильній камері. Ви підносите чашку до автомата, натискаєте на важіль, і ... нічого не виходить. Ох, ох. Ви виявили якийсь дефект. Що ви будете робити? Ви, мабуть, почнете розслідування, щоб визначити першопричину проблеми.

**Знайти першопричину:** Оскільки ви чуєте, як диспенсер для льоду намагається доставити лід, справа, ймовірно, не в самому механізмі доставки льоду. Тому ви відкриваєте морозильну камеру і перевіряєте лоток для льоду. Льоду немає. Це першопричина проблеми? Ні, це ще один симптом. Після подальшого огляду ви визначаєте, що льодогенератор, схоже, не виробляє лід. Проблема в льодогенераторі чи в чомусь іншому? Морозильна камера все ще холодна, водопровід не засмічений, і все інше, здається, працює, тому ви робите висновок, що першопричиною є несправність льодогенератора.

**Зрозумійте проблему:** У цьому випадку все просто. Несправний льодогенератор не буде робити лід.

**Визначте спосіб вирішення проблеми:** На цьому етапі у вас є кілька варіантів вирішення проблеми: Ви можете обійти проблему (купити мішки з льодом у магазині). Ви можете спробувати додатково продіагностувати льодогенератор, щоб побачити, чи є якась деталь, яку можна відремонтувати. Можна купити новий льодогенератор і встановити його на місце старого. Або можна купити нову морозильну камеру. Ви вирішили купити новий льодогенератор.

**Вирішіть проблему:** Щойно льодогенератор прибув, ви його встановили.

**Повторне тестування:** Після ввімкнення електроенергії та очікування протягом ночі ваш новий льодогенератор починає виробляти лід. Ніяких нових проблем не виявлено.

Тепер давайте застосуємо цей процес до нашої простої програми з попереднього уроку:

```cpp
#include <iostream>

int add(int x, int y) // this function is supposed to perform addition
{
    return x - y; // but it doesn't due to the wrong operator being used
}

int main()
{
    std::cout << "5 + 3 = " << add(5, 3) << '\\n'; // should produce 8, but produces 2

    return 0;
}
```

Цей код гарний в одному відношенні: помилка дуже очевидна, тому що неправильна відповідь виводиться на екран у рядку 10. Це дає нам відправну точку для нашого дослідження.

**Знайдіть першопричину:** У рядку 10 ми бачимо, що аргументи (5 і 3) передаються літералами, тому тут немає місця для помилки. Оскільки вхідні дані для функції add правильні, а вихідні - ні, то цілком очевидно, що функція add видає неправильне значення. Єдиний оператор у функції add - це оператор return, який і повинен бути винуватцем. Ми знайшли проблемний рядок. Тепер, коли ми знаємо, на чому зосередити нашу увагу, помітити, що ми віднімаємо, а не додаємо - це те, що ви, швидше за все, виявите під час перевірки.

**Зрозумійте проблему:** У цьому випадку очевидно, чому генерується неправильне значення - ми використовуємо неправильний оператор.

**Визначте, як це виправити:** Ми просто змінимо оператор- на оператор+.

**Виправте проблему:** Це фактично зміна operator- на operator+ і перекомпіляція програми.

**Повторний запуск:** Після внесення змін повторний запуск програми покаже, що наша програма тепер видає правильне значення 8. Для цієї простої програми це все, що потрібно для тестування.

Цей приклад тривіальний, але ілюструє основний процес, через який ви пройдете при діагностиці будь-якої програми.